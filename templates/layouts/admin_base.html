{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>{% block title %}Admin - Queue Management System{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{% static 'css/style-modern.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body data-page="admin-layout">
    {% if user.is_staff and user.is_superuser %}
        {% include 'components/sidebar.html' %}
    {% endif %}
    
    <main class="main-content">
        <div class="container-fluid">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
            
            {% block content %}{% endblock %}
        </div>
    </main>
    
    {% include 'components/footer.html' %}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script>
        // Smart Sidebar - Expand on hover, collapse on mouse leave
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const sidebarCollapseBtn = document.getElementById('sidebarCollapseBtn');
            let expandTimeout;
            
            if (sidebar) {
                // Expand on mouse enter
                sidebar.addEventListener('mouseenter', function() {
                    clearTimeout(expandTimeout);
                    sidebar.classList.add('expanded');
                });
                
                // Collapse on mouse leave
                sidebar.addEventListener('mouseleave', function() {
                    expandTimeout = setTimeout(function() {
                        sidebar.classList.remove('expanded');
                    }, 500); // 500ms delay before collapsing
                });
                
                // Toggle expanded state on button click
                if (sidebarCollapseBtn) {
                    sidebarCollapseBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        clearTimeout(expandTimeout);
                        sidebar.classList.toggle('expanded');
                    });
                }
            }
        });

        // Sidebar Toggle for Mobile
        document.getElementById('sidebarToggle')?.addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('show');
        });

        // Close sidebar when clicking on a nav link (mobile)
        document.querySelectorAll('.sidebar .nav-link').forEach(link => {
            link.addEventListener('click', function() {
                if (window.innerWidth < 992) {
                    document.getElementById('sidebar').classList.remove('show');
                }
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
